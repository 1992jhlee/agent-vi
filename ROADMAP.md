# Agent-VI 로드맵

## 프로젝트 방향

Agent-VI는 단계적으로 기능을 확장하며, 작은 기능부터 시작하여 점진적으로 발전시켜 나가는 방식을 채택합니다.

---

## Phase 1: 프로젝트 기반 구축 ✅ (완료)

**기간**: 2026-01-15 ~ 2026-01-18

### 백엔드
- FastAPI 프로젝트 초기화
- PostgreSQL + SQLAlchemy 2.0 설정
- 데이터베이스 모델 7개 작성
  - Company, FinancialStatement, StockPrice, ValuationMetric
  - AnalysisRun, AnalysisReport, NewsArticle
- Alembic 마이그레이션 설정
- 기본 API 라우터 구조

### 프론트엔드
- Next.js 15 프로젝트 초기화 (App Router)
- Tailwind CSS 설정
- 페이지 골격 생성
- API 클라이언트 기본 구조

### 문서
- README.md, ROADMAP.md, TODO.md 작성

---

## Phase 2: 데이터 소스 & LLM 통합 ✅ (완료)

**기간**: 2026-01-19 ~ 2026-01-22

### 데이터 소스 클라이언트
- **DART 클라이언트** (`dart_client.py`)
  - OpenDartReader 래핑
  - 재무제표 조회 (연간/분기)
  - 재무 데이터 파싱
  - 기업코드 조회

- **주가 데이터 클라이언트** (`stock_client.py`)
  - pykrx 래핑
  - OHLCV 데이터 조회
  - 펀더멘털 데이터 (PER, PBR, 배당수익률)
  - 수익률 계산

- **네이버 API 클라이언트** (`naver_client.py`)
  - 뉴스 검색
  - 블로그 검색
  - HTML 태그 제거

### LLM 설정
- LiteLLM 프로바이더 설정 (`llm/provider.py`)
- OpenAI 및 Anthropic 설정
- 비용 추적 로깅

### 테스트
- 각 클라이언트별 통합 테스트 작성

---

## Phase 3: 에이전트 파이프라인 ✅ (완료)

**기간**: 2026-01-23 ~ 2026-01-26

### LangGraph 그래프
- 병렬 실행 구조 (fan-out/fan-in)
- Orchestrator 노드 (start, merge)
- 에러 핸들링

### 에이전트
- **정보 수집 에이전트**: DART 공시 + 뉴스 검색
- **재무 분석 에이전트**: 재무제표 + 주가 분석
- **가치투자 평가 에이전트**: Deep Value + Quality 평가
- **보고서 생성 에이전트**: 최종 보고서 작성

### Knowledge Base
- `knowledge/deep_value.md`: Deep Value 투자 철학
- `knowledge/quality.md`: Quality 투자 철학

---

## Phase 4: API & 프론트엔드 ✅ (완료)

**기간**: 2026-01-27 ~ 2026-01-29

### 분석 실행 API
- 백그라운드 분석 실행 (ThreadPoolExecutor)
- 실시간 상태 조회
- 에러 처리

### 서비스 레이어
- `analysis_service.py`: LangGraph 파이프라인 호출

### 프론트엔드 페이지
- 홈 페이지 (최근 보고서 + 통계)
- 보고서 목록 (필터/정렬)
- 보고서 상세 (전체 분석 내용)
- 관리자 대시보드 (분석 실행 UI)

### ISR 재검증
- 백엔드 웹훅 호출
- 프론트엔드 `/api/revalidate` 구현

---

## Phase 5: 재무실적 뷰어 MVP ✅ (완료)

**기간**: 2026-01-30

### 목표
간단하고 실용적인 재무실적 조회 기능부터 시작

### 백엔드 개발
- **종목 검색 API** (`stocks.py`)
  - pykrx 전체 종목 리스트 캐싱
  - 종목명/종목코드 자동완성 검색

- **증분 데이터 수집** (`financial_service.py`)
  - DB에서 기존 데이터 확인
  - 없는 연도/분기만 DART에서 수집
  - 중복 방지 로직
  - **데이터 수집 범위 확장**: 6년 연간 + 8분기
  - **메타데이터 저장**: 추정 여부 및 출처

- **스마트 파싱** (`dart_client.py`)
  - **컨텍스트 기반 매출액 추정**: "매출액" 없을 시 손익계산서 최상단 수익 항목 사용
  - **메타데이터 생성**: 추정 여부 및 원본 계정과목명 기록
  - 여러 계정과목명 패턴 지원 ("매출액", "영업수익" 등)

- **종목 등록 API 수정** (`companies.py`)
  - BackgroundTasks로 재무데이터 자동 수집
  - DART 기업코드 자동 조회

- **재수집 API** (`financials.py`)
  - 수동 재무데이터 갱신
  - force 옵션으로 기존 데이터 덮어쓰기
  - **메타데이터 응답**: 추정값 정보 포함

- **CORS 설정** (`main.py`)
  - localhost:3001 지원 추가 (로컬 개발용)

### 프론트엔드 개발
- **재무표 컴포넌트** (`FinancialTable.tsx`)
  - **테이블 transpose**: 행=항목(매출액/영업이익/순이익), 열=연도/분기
  - 억 원 단위 포맷팅
  - 전년 대비 증감률 표시 (매출액만)
  - **추정값 표시**: * 표시 + 호버 툴팁
  - **발표 전 데이터**: "(발표 전)" 텍스트 표시

- **종목 등록 모달** (`CompanyCreateModal.tsx`)
  - 종목명 자동완성
  - 디바운싱 (300ms)
  - 선택된 종목 확인 UI

- **종목 상세 페이지** (`companies/[stock_code]/page.tsx`)
  - 연간 실적 표 (최근 6년)
  - 분기 실적 표 (최근 8분기)
  - **뒤로 가기 버튼** (목록으로 이동)

- **종목 목록 페이지** (`companies/page.tsx`)
  - 검색 및 필터링
  - 페이지네이션
  - 종목 등록 버튼

### 문서 업데이트
- README.md: 재무실적 뷰어 중심으로 재작성
- ROADMAP.md: 새로운 단계별 로드맵
- TODO.md: Phase 5 완료 반영

### 주요 성과
- ✅ 종목명 자동완성 검색
- ✅ 재무실적 표시 (연간 6년 + 분기 8개)
- ✅ 증분 데이터 수집 (중복 방지)
- ✅ 억 원 단위 표시 & 전년대비 증감률
- ✅ **스마트 파싱**: 계정과목명 차이 자동 처리
- ✅ **추정값 투명성**: 사용자에게 추정 여부 명시 (* 표시 + 툴팁)
- ✅ **테이블 transpose**: 가독성 향상 (행=항목, 열=기간)
- ✅ **발표 전 데이터 구분**: 미발표 실적 명시
- ✅ **뒤로 가기 버튼**: UX 개선
- ✅ 기존 AI 분석 코드 유지 (나중에 재사용)

---

## Phase 6: 데이터 시각화 📋 (계획)

**예상 기간**: 2026-02

### 차트 라이브러리
- Recharts 설치 및 설정

### 재무 트렌드 차트
- 매출액/영업이익/순이익 추세선
- 연간 vs 분기 토글
- 반응형 디자인

### 주가 차트
- OHLCV 차트
- 이동평균선 (20일, 60일, 120일)
- 거래량 막대 차트

### 밸류에이션 차트
- PER, PBR 추세
- 업종 평균 대비 비교
- 레이더 차트 (Deep Value vs Quality 점수)

---

## Phase 7: AI 분석 재활성화 📋 (계획)

**예상 기간**: 2026-03

### 기존 에이전트 재사용
- Phase 3에서 구현한 LangGraph 파이프라인 활용
- `agents/` 폴더 코드 재활성화

### 투자 보고서 생성
- 관리자 대시보드에서 분석 실행
- 백그라운드 작업으로 보고서 생성
- 보고서 페이지에서 확인

### 스케줄링 (APScheduler)
- 일일 주가 업데이트
- 주간 전체 분석
- 분기 재무 업데이트

### 투자 철학 편집 UI
- Markdown 에디터 추가
- 실시간 미리보기
- 변경 이력 (선택사항)

---

## Phase 8: 배포 & 최적화 📋 (계획)

**예상 기간**: 2026-04

### 백엔드 배포
- Koyeb / Railway / Fly.io
- 환경 변수 설정
- 도메인 연결

### 프론트엔드 배포
- Vercel 배포
- ISR 설정 최적화
- 도메인 연결

### 데이터베이스
- Neon / Supabase
- 백업 설정
- 인덱스 최적화

### 모니터링
- Sentry 연동
- 로깅 시스템
- 알림 설정

### 성능 최적화
- DB 쿼리 최적화
- API 응답 캐싱
- CDN 설정

---

## 장기 목표 (2026 H2)

### 고급 분석 기능
- 업종 비교 분석
- 동종 업계 벤치마킹
- 시계열 예측 (매출/이익)

### 포트폴리오 관리
- 관심 종목 포트폴리오
- 수익률 추적
- 알림 설정

### 커뮤니티 기능
- 투자 아이디어 공유
- 보고서 댓글
- 사용자 평점

---

## 완료 상황

- ✅ Phase 1: 프로젝트 기반 구축
- ✅ Phase 2: 데이터 소스 & LLM
- ✅ Phase 3: 에이전트 파이프라인
- ✅ Phase 4: API & 프론트엔드
- ✅ Phase 5: 재무실적 뷰어 MVP
- 📋 Phase 6: 데이터 시각화 (다음 단계)
- 📋 Phase 7: AI 분석 재활성화
- 📋 Phase 8: 배포 & 최적화
